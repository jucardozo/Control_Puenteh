/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/

#include "SysTick.h"
#include "hardware.h"

#define SYSTICK SysTick
/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/


/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 ******************************************************************************/
//static (*callback_imp)(void) [10];
/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/
void (*callback)(void)=0;

bool SysTick_Init (void (*funcallback)(void))
{
	static bool yaInit=false;
	if (!yaInit)
	{
		SYSTICK->CTRL = 0x00;
		SYSTICK->LOAD = 12500000L-1;//125ms		//26us @ 100Mhz
		SYSTICK->VAL = 0x00;
		SYSTICK->CTRL = SysTick_CTRL_CLKSOURCE_Msk | SysTick_CTRL_TICKINT_Msk|SysTick_CTRL_ENABLE_Msk;
		callback=funcallback;
		yaInit=true;
		return true;
	}
	else return false;
}

void addCallback_imp();
/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/
__ISR__ SysTick_Handler(void)
{
	if(callback) callback();
}


/*******************************************************************************
 ******************************************************************************/
